# 控制器
在前面[简单访问](https://wiki.nb.cx/visit.htm)章节里,我们已经知道了控制器的基本用法了。
这个章节主要介绍`nb\Controller`类的使用，当我们的控制器继承了`nb\Controller`类后，可以得到那些便利。

`nb\Controller`类主要整合了下面组件的功能：

|组件名称  |
|:-----  |
|nb\\Validate|
|nb\\View  |
|nb\\Request|

### 在控制器里使用视图
在[视图与模板](https://wiki.nb.cx/view.htm)章节里，我们介绍了视图组件的独立用法，如果继承了`nb\Controller`，我们就可以这样使用了。
```php
namespace controller;

use nb\Controller;

class Index extends Controller {

    public function view() {
        $this->assign('hello','NB Framework');
        $this->display();
    }
}
```
`assign`,`display`函数和view组件里函数使用方式是一样的，包括参数。

我们可以通过这样的方式获取到视图组件的对象，来调用视图组件的其它函数
```php
//视图组件对象，有框架自动赋值
$this->view;
//对视图组件进行动态设置
$this->view->config('name','vale');

//关闭视图的布局功能
$this->view->layout(false);
```
### 在控制器里使用数据校验
在[数据校验](https://wiki.nb.cx/validate.htm)章节里，我们通过独立的验证器，来做不同的情景下的数据验证。
在[简单访问](https://wiki.nb.cx/visit.htm)章节里，我们可以把验证器里的规则和提示信息写进控制器里直接简化使用。

但是在有些场景下，比如我在GET请求下显示页面，在POST下处理表单数据。
这时，显然GET下是没有参数的，如果这样定义：
```php
namespace controller;

use nb\Controller;

class Control extends Controller {

    public $_rule = [
        'name'  =>  'require|max:25',
        'pass'  =>  'require|email',
    ];

    //直接在验证器类中使用message属性定义错误提示信息
    //如果没有定义错误提示信息，则使用系统默认的提示信息
    public $_message  =   [
        'name.require' => '名称必须',
        'name.max'     => '名称最多不能超过25个字符',
        'pass'        => '邮箱格式错误',
    ];

    public function login($user,$pass) {
        if($this->isGet) {
            $this->display();
        }
        //验证用户名
        // ...
    }
}
```
这显然是不行的，此时我们就不能使用自动传参了。
如何解决这个问题，请看下面部分。

### 在控制器里获取表单数据
控制器本身支持自动传参，但如果参数过多，或者出现上面情况的话，我们就可以使用下面方法独立获取参数了。
```php
public function login() {
    if($this->isGet) {
        $this->display();
    }
    //获取用户名和密码
    list($user,$pass) = $this->input('user','pass');
    //也可以这样获取
    $form = $this->form();
    $user = $form['user'];
    $pass = $form['pass'];
}
```
这里的`input`,`form`,包括`formx`函数，和[请求](https://wiki.nb.cx/request.htm)章节里介绍的`nb\Request`类里的函数用法是一致的。

并且，用控制器提供的`input`,`form`和`formx`函数，会自动根据控制器定义的验证规则对数据进行验证。



### 在控制器里使用验证器



